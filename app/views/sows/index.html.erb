<div class="span2">

      <!--Sidebar content-->
       <div class="well sidebar-nav">
        <h3>Contract details</h3>
        <table id="tb" class="table  table-condensed table-hover " cellspacing="0">
            <thead>
                <tr>
                    <th class='hed'></th>
                    <th class='hed'></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class='hed'>Client name: </td>
                    <td><%= @contract.client.name %> </td>
                </tr>
                <tr>
                    <td class='hed'>Client state: </td>
                    <td><%= @contract.client.state %> </td>
                </tr>
                <tr>
                    <td class='hed'>Real cust_id: </td>
                    <td><%= @contract.client.cust_id  %> </td>
                </tr>
                 <tr>
                    <td class='hed'>BAA: </td>
                    <td>
                         <div id="baa_date" class="ct_date" data-resource="contract" data-type="date" data-pk="1"  data-url="/contracts/<%= @contract.id %>" data-value = "<%= @contract.baa_date %>" >
                        </div>
                    </td>
                </tr>
                <tr>
                    <div>         
                        <button id="enable" class="btn btn-primary">enable/disable edit</button>
                    </div>  
                </tr>
            </tbody>
        </table> 
      </div><!--/.well -->
</div>

<div class="span8">
<!--Body content-->

    <div id="container" class="container-fluid">
        <h1>Listing SOWs </h1>
        <% if @sows.empty? %> 
            <div class="notice"> You do not have any SOW currently. please add one! </div>
        <% else %>
                <div class="accordion" id="accordion2">  
                    <% @sows.each do |sow| %>
               
                        <div class="accordion-group">  
                            <div class="accordion-heading">  
                                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapse<%= sow.id %>">  
                                  <h3 class="text-info">Statement of Work ( Product: <%= Product.find(sow.product_id).name %> ) </h3>
                                </a>  
                            </div>  
                            <div id="collapse<%= sow.id %>" class="accordion-body collapse" style="height: 0px; ">  
                                <div class="accordion-inner">  
                                  
                                    <h4 class="text-info">SOW Progress </h4>
                                    <table id="tb" class="table table-striped table-condensed table-hover table-bordered" cellspacing="0">
                                        <tr>
                                            <th>KO date </th>
                                            <th>Production date</th>
                                            <th>Sow start date </th>
                                            <th>Sow end date</th>
                                            <th>Auto renew</th>
                                            <th>Accept term</th>
                                            <th>Renewal</th>
                                            <th>Renew times</th>
                                            <th>Comment</th>
                                            <th></th>
                                        </tr>
                                        <tr>
                                            <td><%= sow.sow_ko_date %></td>
                                            <td><%= sow.sow_production_date %></td>
                                            <td><%= sow.sow_start_date %></td>
                                            <td><%= sow.sow_end_date %></td>
                                            <td><%= sow.auto_renew %></td>
                                            <td><%= sow.accept_term %></td>
                                            <td><%= sow.renewal %></td>
                                            <td><%= sow.renew_times %></td>  
                                            <td><%= sow.comment %></td>
                                            <td><%= link_to 'Destroy', sow, confirm: 'Are you sure?', method: :delete %></td>
                                        </tr>  
                                    </table>
                             
                                         <%= button_to "New Draft", new_sow_sow_detail_path(sow), :method => "get", class: "btn btn-primary btn-small"  %>
                                        <h4 class="text-info">Listing Drafts </h4>
                                        <% if ! sow.sow_details.nil? %>
                                            <table id="tb" class="table table-striped table-condensed table-hover table-bordered" cellspacing="0">
                                                <tr>
                                                    <th>Version </th>
                                                    <% SowDetail.columns.map {|c| c.name }.each do |col| %>
                                                        <% if exclude_column(col) and  sow.sow_detail_template.send(col) %>
                                                            <th><%=col.capitalize %> </th>
                                                        <% end %>
                                                    <% end %>
                                                    <th>Created_at </th>
                                                </tr>
                                                <% sow.sow_details.each do |detail| %>
                                                     <tr>
                                                        <th><%=detail.send(:version) %> </th>
                                                        <% SowDetail.columns.map {|c| c.name }.each do |col| %>
                                                            <% if exclude_column(col) and sow.sow_detail_template.send(col) %>
                                                                <th><%=detail.send(col) %> </th>
                                                            <% end %>
                                                        <% end %>
                                                        <th><%=detail.send(:created_at) %> </th>
                                                     </tr> 
                                                <% end %>
                                            </table>    
                                        <% end %>
                                  
                                </div>
                            </div>
                        </div>    
                    <% end %>          
                </div>   
        <% end %>
        <br />


 
    <%= button_to "New Sow", new_contract_sow_path(@contract), :method => "get" %>
 

<script>
 
    $(function(){
        $('.ct_date').editable({
            ajaxOptions: {
                type: 'PUT'
            },
            format: 'yyyy-mm-dd',    
            viewformat: 'dd/mm/yyyy',    
            datepicker: {
                    weekStart: 1
            }

        });
        $('#enable').click(function() {
            $('#tb .editable').editable('toggleDisabled');
        });  
        $('.ct_description').editable({
            ajaxOptions: {
                type: 'PUT'
            },
            title: 'Enter Description',

        });
                $('#tb .editable').editable('toggleDisabled');
    });
</script>
    </div>
</div>